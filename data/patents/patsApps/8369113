
A power conditioning unit for delivering power from a power source to a mains utility supply, the power conditioning unit comprising a plurality of input terminals for connecting to the power source, a plurality of output terminals for connecting to the mains utility supply, a voltage increasing converter connected to the input terminals, a voltage reducing converter connected to the voltage increasing converter and a dc-to-ac converter connected to the voltage reducing converter and to the output terminals.



1. A photovoltaic power conditioning unit for delivering power from a photovoltaic dc power source to a grid mains utility supply, the power conditioning unit comprising:
a plurality of input terminals for connecting to the dc power source;
a plurality of output terminals for connecting to the grid mains utility supply;
a voltage increasing converter connected to the input terminals;
a voltage reducing converter connected to the voltage increasing converter;
a dc-to-ac converter connected to the voltage reducing converter and to the output terminals and comprising a current source inverter;
a synchronization circuit coupled to the output terminals configured to generate a synchronization signal that is synchronized with the grid mains utility supply;
a reference signal generation circuit that is coupled to the synchronization circuit and configured to generate a sinusoidal reference signal template in synchronism with the grid mains utility supply based on the synchronization signal;
a current sensor configured to sense a current flowing through the voltage reducing converter and to provide a current sense signal; and
a comparator configured to compare an instantaneous value of the sinusoidal reference signal template with an instantaneous value of the current sense signal and to provide an output to control the voltage reducing converter to regulate sinusoidal current injection by the current source inverter into the grid mains utility supply.



2. A photovoltaic power conditioning unit according to claim 1, wherein the voltage reducing converter and the dc-to-ac converter share an inductor and wherein the inductor is configured to function as an energy storage inductor in the voltage reducing converter and as a current smoothing inductor in the dc-to-ac converter.


3. A photovoltaic power conditioning unit according to claim 1, wherein the dc-to-ac converter comprises a plurality of transistors and a plurality of protection diodes connected in series with the transistors so that the protection diodes prevent current flow in the reverse direction in the transistors.


4. A photovoltaic power conditioning unit as claimed in claim 1, wherein the voltage increasing converter comprises a dc-to-dc converter, wherein the dc-to-dc converter and the dc-to-ac converter share an inductor and wherein the inductor is configured to function as an energy storage inductor in the dc-to-dc converter and as a current smoothing inductor in the dc-to-ac converter, and wherein the sinusoidal current injection is regulated based on current mode control in the inductor based on buck-type stage of the dc-to-dc converter.


5. A photovoltaic power conditioning unit as claimed in claim 1, the dc-to-ac converter comprising:
a dc connection to the dc photovoltaic power source;
an ac connection to the grid mains utility supply; and
a plurality of transistors and a plurality of protection diodes connected in series between the dc connection and the ac connection;
a current control transistor and an inductor connected in series to an input to the dc-to-ac converter to control current injection into the grid mains utility supply;
a first diode connected between a first node between the current control transistor and the inductor and a second node connected to an input of said dc-to-ac converter; and
a second diode connected in series with the current control transistor to protect the current control transistor by inhibiting current from flowing back through the current control transistor when the current control transistor is switched off.



6. A power conditioning unit according to claim 5, wherein the dc connection comprises two dc connection terminals, the ac connection comprises two ac connection terminals, a first transistor and a first protection diode being connected in series between the first dc connection terminal and the first ac connection terminal, a second transistor and a second protection diode being connected in series between the first dc connection terminal and the second ac connection terminal, a third transistor and a third protection diode being connected in series between the second dc connection terminal and the first ac connection terminal and a fourth transistor and a fourth protection diode being connected between the second dc connection terminal and the second ac connection terminal.


7. A power conditioning unit as claimed in claim 1, further comprising a buffer coupled between the comparator and the voltage reducing converter to buffer an output of the comparator.


8. A power conditioning unit as claimed in claim 7, wherein the buffer operates at a greater frequency than a frequency of the grid mains utility supply.


9. A power conditioning unit as claimed in claim 1, wherein the reference signal generation circuit comprises:
a digital-to-analogue converter configured to provide an amplitude control signal; and
a circuit configured to control an amplitude of the rectified sinusoidal signal template in response to the amplitude control signal.



10. A method of controlling a photovoltaic power conditioning unit, the photovoltaic power conditioning unit comprising a plurality of input terminals for connecting to a dc power source, a voltage increasing converter connected to the input terminals, a voltage reducing converter connected to the voltage increasing converter, a dc-to-ac converter connected to the voltage reducing converter and a plurality of output terminals for connecting to a grid mains utility supply, the output terminals being connected to the dc-to-ac converter, the method comprising:
sensing a voltage on the output terminals;
generating a reference current responsive to said sensing;
sensing a supply current in the dc-to-ac converter;
controlling the voltage reducing converter responsive to a difference between the reference current and the supply current;
using the dc-to-ac converter as a current source inverter to control power injected into the grid mains utility supply;
generating a sinusoidal reference signal template in synchronism with the grid mains utility supply;
comparing an instantaneous value of the sinusoidal reference signal with an instantaneous value of the sensed supply current; and
regulating sinusoidal current injection by the current source inverter into the grid mains utility supply by controlling the voltage reducing converter in response to the comparison of the instantaneous value of the sinusoidal reference signal with the instantaneous value of the sensed supply current.



11. A method as claimed in claim 10, wherein generating the sinusoidal reference signal comprises generating a full wave rectified sinusoidal reference signal template.


12. A method as claimed in claim 11 wherein said voltage reducing converter incorporates a power control switch and said controlling comprises turning the switch off if the supply current is greater than the reference current and turning the switch on if the supply current is less than the reference current, and wherein the switch is controlled in synchronism with the sinusoidal reference signal template.


13. A method as claimed in claim 10 wherein said voltage reducing converter incorporates a power control switch and said controlling comprises turning the switch off if the supply current is greater than the reference current and turning the switch on if the supply current is less than the reference current.


14. A photovoltaic power conditioning unit for delivering power from a photovoltaic dc power source to a grid mains utility supply, the power conditioning unit comprising:
a plurality of input terminals for connecting to the photovoltaic dc power source;
a plurality of output terminals for connecting to the grid mains utility supply;
a voltage increasing converter connected to the input terminals;
a voltage reducing converter connected to the voltage increasing converter, the voltage reducing converter comprising a current control transistor and an inductor connected in series with an input to a dc-to-ac converter;
the dc-to-ac converter connected to the output terminals and comprising an input connected in series with the inductor of the voltage reducing converter;
a voltage sensor for sensing a voltage on the output terminals;
a reference current generator for generating a reference current iref responsive to the sensing;
a current sensor for sensing a supply current iout in the dc-to-ac converter; and
a comparator for controlling the voltage reducing convertor and switching of the transistor responsive to a difference between the reference current and the sensed supply current, such that the transistor is turned off in response to the reference current iref being greater than the supply current iout and such that the transistor is turned on if the reference current iref is less than the supply current iout, and wherein current through the inductor follows a rectified sinusoid which is unfolded by the dc-to-ac converter to provide a sinusoidal current synchronously injected into the grid mains utility supply.



15. A method of controlling a photovoltaic power conditioning unit, the power conditioning unit comprising a plurality of input terminals for connecting to a photovoltaic dc power source, a voltage increasing converter connected to the input terminals, a voltage reducing converter connected to the voltage increasing converter, a dc-to-ac converter connected to the voltage reducing converter, a plurality of output terminals for connecting to a grid mains utility supply with the output terminals being connected to the dc-to-ac converter, a voltage sensor for sensing a voltage on the output terminals, a reference current generator for generating a reference current iref responsive to the sensing, a current sensor for sensing a supply current iout in the dc-to-ac converter, a current control transistor and an inductor connected in series with an input to the dc-to-ac converter, and a comparator for controlling the voltage reducing converter and switching of the current control transistor responsive to a difference between the reference current and the supply current, the method comprising:
sensing a voltage on the output terminals;
generating a reference current responsive to the sensing of the voltage,
sensing a supply current in the dc-to-ac converter;
controlling the voltage reducing converter responsive to a difference between the reference current and the supply current;
switching the current control transistor responsive to the difference between the reference current and the supply current such that if the reference current iref>iout the transistor is turned on and if the reference current iref<iout the transistor is turned off;
controlling power injected into the grid mains utility supply such that current through the inductor follows a rectified sinusoid;
unfolding the rectified sinusoidal current through the inductor using the dc-to-ac converter to provide a sinusoidal current; and
synchronously injecting the sinusoidal current into the grid mains utility supply.


