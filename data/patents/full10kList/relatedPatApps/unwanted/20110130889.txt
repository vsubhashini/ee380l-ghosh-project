Described herein are methods, systems, and apparatus for a controller for a power circuit that interfaces distributed power generation with a power distribution grid, comprising: a first portion, including a maximum power point tracker, that receives signals corresponding to the distributed power generation voltage and current, and outputs to the power circuit a signal for controlling the voltage of the distributed power generation; a second portion, including a current reference generator, a current controller, and a dc voltage controller, that receives signals corresponding to a dc voltage of the power circuit, the power distribution grid voltage and current, and the inverter current, and outputs signals for controlling the power circuit output voltage; wherein the current reference generator includes nonlinear circuit elements and generates a current reference signal from the dc voltage of the power circuit and the grid voltage and current; such that substantially harmonic-free power is injected into the power distribution grid. The distributed power generation may be, for example, a photovoltaic module or a wind turbine.
Claims 1. A controller for a power circuit that interfaces distributed power generation with a power distribution grid, comprising: a first portion, including a maximum power point tracker, that receives signals corresponding to the distributed power generation voltage and current, and outputs to the power circuit a signal for controlling the voltage of the distributed power generation; a second portion, including a current reference generator, a current controller, and a dc voltage controller, that receives signals corresponding to a dc voltage of the power circuit, the power distribution grid voltage and current, and the inverter current, and outputs signals for controlling the power circuit output voltage; wherein the current reference generator includes nonlinear circuit elements and generates a current reference signal from the dc voltage of the power circuit and the grid voltage and current; such that substantially harmonic-free power is injected into the power distribution grid. 2. The controller of claim 1, wherein the power circuit output voltage is controlled by controlling an inverter of the power circuit. 3. The controller of claim 2, wherein the inverter is a current source inverter. 4. The controller of claim 2, wherein the inverter is a voltage source inverter. 5. The controller of claim 1, wherein the distributed power generation includes at least one photovoltaic (PV) module. 6. The controller of claim 1, wherein the current reference generator: (i) includes an instantaneous power calculator that generates an instantaneous power reference signal, and (ii) generates the current reference signal from the instantaneous power reference signal and the grid voltage and current using nonlinear circuit elements. 7. The controller of claim 6, including an enhanced phase locked loop (EPLL). 8. The controller of claim 7, wherein the EPLL provides a phase angle of the grid voltage which is used to generate the instantaneous power reference signal. 9. The controller of claim 6, wherein the instantaneous power calculator calculates the instantaneous power from real and reactive power commands. 10. The controller of claim 9, wherein the real and reactive power commands are set externally. 11. The controller of claim 9, wherein the real power command is generated by an internal proportional integral (PI) controller operating on dc-link voltage error or on dc-link energy error. 12. The controller of claim 1, wherein the current reference generator comprises an energy calculator, a notch filter, and at least one PI controller. 13. The controller of claim 12, including an EPLL. 14. The controller of claim 13, wherein the EPLL generates parallel and orthogonal signals corresponding to the grid voltage. 15. The controller of claim 14, wherein a first PI controller operates on an error between (i) a reference energy signal and (ii) an actual energy signal corresponding to the dc voltage of the power circuit, and multiplies a PI output with the parallel signal from the EPLL to generate a real current component of the current reference signal. 16. The controller of claim 14, wherein a second PI controller operates on an error between (i) a reference reactive power signal and (ii) an actual reactive power signal corresponding to the output power of the power circuit, and multiplies a PI output with the orthogonal signal from the EPLL to generate a reactive component of the current reference signal. 17. The controller of claim 1, wherein the current controller includes a semi-state feedback control structure combined with a resonant-type output feedback portion. 18. The controller of claim 1, wherein the current controller includes a semi-state feedback control structure combined with a resonant-type output feedback portion and a soft-start feed forward controller. 19. The controller of claim 18, wherein the current controller includes one or more resonant-type output feedback portions. 20. The controller of claim 19, wherein each resonant-type output feedback portion corresponds to a harmonic of the grid voltage. 21. The controller of claim 18, wherein the current controller includes: (i) one or more resonant-type harmonic controllers acting on grid current; (ii) an integrating controller acting on grid current; (iii) a wide band harmonic controller in parallel with the resonant-type controller; (iv) a wide band harmonic controller in series with the resonant-type controller; or (v) a wide band feed forward harmonic compensator acting on the grid voltage signal; or (vi) at least a portion of one or more of (i) to (v). 22. The controller of claim 21, wherein the wide band harmonic controller has a proportional, proportional-derivative, lead, or lead-lag configuration. 23. The controller of claim 21, wherein the wide band feed forward harmonic compensator has a proportional, proportional-derivative, lead, or lead-lag configuration. 24-32. (canceled) 33. A method for controlling a power circuit that interfaces distributed power generation with a power distribution grid, comprising: controlling a voltage of the distributed power generation using signals corresponding to the distributed power generation voltage and current; generating a current reference signal and controlling the power circuit output voltage using signals corresponding to (i) a dc voltage of the power circuit and (ii) the power distribution grid voltage and current; wherein generating the current reference signal includes using a current reference generator with nonlinear circuit elements; such that substantially harmonic-free power is injected into the power distribution grid. 34. The method of claim 33, wherein the power circuit output voltage is controlled by controlling an inverter of the power circuit. 35. The method of claim 34, wherein the inverter is a current source inverter. 36. The method of claim 34, wherein the inverter is a voltage source inverter. 37. The method of claim 33, wherein the distributed power generation includes at least one PV module. 38. The method of claim 33, including generating an instantaneous power reference signal, and generating the current reference signal from the instantaneous power reference signal and the grid voltage and current using nonlinear circuit elements. 39. The method of claim 38, including using a phase angle of the grid voltage to generate the instantaneous power reference signal. 40. The method of claim 39, including using an EPLL to provide the phase angle of the grid voltage. 41. The method of claim 38, including calculating the instantaneous power from real and reactive power commands. 42. The method of claim 41, including setting the real and reactive power commands externally. 43. The method of claim 41, including generating the real power command by an internal PI controller operating on a dc-link voltage error. 44. The method of claim 41, including generating the reactive power command by an internal PI controller operating on a voltage magnitude error. 45. The method of claim 33, including generating parallel and orthogonal signals corresponding to the grid voltage. 46. The method of claim 45, including generating a real current component of the current reference signal from an error between a reference energy signal and an actual energy signal corresponding to the dc voltage of the power circuit, multiplied with the parallel signal. 47. The method of claim 45, including generating a reactive component of the current reference signal from an error between a reference reactive power signal and an actual reactive power signal corresponding to the output power of the power circuit, multiplied with the orthogonal signal. 48. The method of claim 45, including using an EPLL to generate the parallel and orthogonal signals corresponding to the grid voltage. 49. The method of claim 33, including using a semi-state feedback control structure combined with a resonant-type output feedback portion in the current controller. 50. The method of claim 49, including using a feed forward soft start controller. 51. The method of claim 33, including using a semi-state feedback combined with one or more resonant-type output feedback portions in the current controller. 52. The method of claim 51, wherein each resonant-type output feedback portion corresponds to a harmonic of the grid voltage. 53. The method of claim 50, including using in the current controller: (i) one or more resonant-type harmonic controllers acting on grid current; (ii) an integrating controller acting on grid current; (iii) a wide band harmonic controller in parallel with the resonant-type controller; (iv) a wide band harmonic controller in series with the resonant-type controller; or (v) a wide band feed forward harmonic compensator acting on the grid voltage signal; or (vi) at least a portion of one or more of (i) to (v). 54. The method of claim 53, wherein the wide band harmonic controller has a proportional, proportional-derivative, lead, or lead-lag configuration. 55. The method of claim 53, wherein the wide band feed forward harmonic compensator has a proportional, proportional-derivative, lead, or lead-lag configuration. 