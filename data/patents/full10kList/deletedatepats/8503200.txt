An apparatus and method for controlling the delivery of a pre-determined amount of power from a DC source to an AC grid includes an inverter and an inverter controller. The inverter includes an input converter, an energy storage capacitor, and an output converter. The inverter controller includes an input converter controller and an output converter controller. The input converter controller includes feedforward controller configured to perform a calculation to determine a value for the duty cycle for the input converter such that: (1) the input converter delivers the pre-determined amount of power and (2) the magnitude of a ripple signal reflected into the input source is attenuated toward zero. The input converter controller may also include a quadrature corrector configured to determine the effectiveness of the calculation in attenuating the ripple and to adaptively alter the calculation to improve the effectiveness.
Claims The invention claimed is: 1. An apparatus for controlling the delivery of power from a unipolar input source to an alternating-current (AC) grid, the AC grid characterized by a grid voltage, V.sub.rms, a nominal grid frequency .omega., and a grid phase .theta., the apparatus comprising: an inverter including (i) an input converter configured to deliver power from the unipolar input source to a unipolar bus, (ii) an energy storage element coupled to the unipolar bus and configured to supply energy to and absorb energy from the unipolar bus, and (iii) an output converter coupled to the unipolar bus and configured to deliver power from the unipolar bus to the AC grid in the form of a substantially sinusoidal current at the grid frequency; and an inverter controller coupled to the inverter, the inverter controller including (i) an output converter controller coupled to the output converter and configured to control the output converter to deliver power to the AC grid and (ii) an input converter controller coupled to the input converter and configured to control a duty cycle of the input converter to control delivery of a pre-determined amount of power from the input source to the unipolar bus, wherein the input converter controller includes (i) means for setting a magnitude of the pre-determined amount of power, (ii) a feedforward controller configured to perform a calculation to determine a value for the duty cycle for the input converter such that: (1) the input converter delivers the pre-determined amount of power and (2) the magnitude of a ripple signal reflected into the input source is attenuated toward zero, and (iii) a quadrature corrector configured to determine the effectiveness of the calculation in attenuating the ripple and to adaptively alter the calculation to improve the effectiveness of the calculation. 2. The apparatus of claim 1, wherein the input source is a photovoltaic ("PV") cell and the means for setting a magnitude comprises a Maximum Power Point Tracking controller. 3. The apparatus of claim 1, wherein the energy storage element is a capacitor. 4. The apparatus of claim 1, wherein the ripple signal comprises a ripple component at a harmonic of the AC grid frequency. 5. The apparatus of claim 4, wherein the ripple signal comprises a second harmonic of the AC grid frequency. 6. The apparatus of claim 1, wherein the feedforward controller is configured to receive a signal, d.sub.0, from the means for setting a magnitude, the signal d.sub.0 being indicative of the duty cycle that is required to deliver the pre-determined amount of power. 7. The apparatus of claim 6, wherein: the quadrature corrector is configured to deliver a phase correction term, .delta., and a gain correction term, k, to the feedforward controller, and the feedforward controller calculates a duty cycle, d, of the form: d=d.sub.0-kC. 8. The apparatus of claim 7, wherein: the energy storage element is a storage capacitor of value C.sub.bus; and the feedforward controller is configured to receive (i) measurements indicative of the value of the rms value of the AC grid voltage, V.sub.rms, (ii) the rms value of the substantially sinusoidal current delivered by the output converter, I.sub.rms, and (iii) the value of the unipolar bus voltage, V.sub.bus0; and to set .times..times..times..omega..times..times..times..times..times..times..fu- nction..times..omega..times..times. ##EQU00033## 9. The apparatus of claim 7, wherein: the energy storage element is a storage capacitor of value C.sub.bus, and the feedforward controller is configured to receive (i) a measurement indicative of the value of the power delivered by the inverter to the AC grid, P.sub.out, and (ii) a value, .phi., indicative of a phase difference between the phase of the current delivered to the AC grid and the phase of the AC grid voltage; and to set .times..times..omega..times..times..times..times..times..times..function.- .PHI..times..function..times..omega..times..times. ##EQU00034## 10. The apparatus of claim 7, wherein: the energy storage element is a storage capacitor of value C.sub.bus, and the feedforward controller is configured to receive (i) a measurement indicative of the power delivered by the unipolar input source, P.sub.s; (ii) a value, .phi., indicative of a phase difference between the phase of the current delivered to the AC grid and the phase of the AC grid voltage; and (iii) a value indicative of the operating efficiency of the inverter, .eta.; and to set .times..times..omega..times..times..times..times..times..times..times..ti- mes..PHI..times..function..times..omega..times..times. ##EQU00035## 11. The apparatus of claim 7, wherein: the energy storage element is a storage capacitor of value C.sub.bus; and the feedforward controller is configured to receive (i) measurements indicative of the value of the voltage delivered by the unipolar input source, V.sub.s, (ii) measurements indicative of the value of the current delivered by the unipolar input source, I.sub.s, (iii) a value, .phi., indicative of a phase difference between the phase of the current delivered to the AC grid and the phase of the AC grid voltage, and (iv) a value indicative of the operating efficiency of the inverter, .eta.; and to set .times..times..times..omega..times..times..times..times..times..times..fu- nction..PHI..times..function..times..omega..times..times. ##EQU00036## 12. The apparatus of claim 7, wherein the quadrature corrector comprises a first low pass filter, the first low pass filter being configured to receive a measurement indicative of the magnitude of an input current delivered by the unipolar input source, i.sub.in, and to deliver a double-frequency signal, .sub.in, indicative of the magnitude of the component of the input current ripple that is twice the frequency of the AC grid frequency. 13. The apparatus of claim 12, wherein the quadrature corrector further comprises a phase error detector configured to generate a phase error signal based upon a difference between the phase of the double-frequency signal and the grid phase, .theta., wherein the phase error signal has a zero average value when said difference is substantially zero. 14. The apparatus of claim 13, wherein the phase error detector comprises: a first phase comparator that receives a signal indicative of the grid phase, .theta., and delivers a signal, Q.sub.2, such that: .times..times..pi.<.function..theta..pi.<.times..pi. ##EQU00037## a first multiplier that delivers a phase error signal, e.sub.2=Q.sub.2 .sub.in; a second low pass filter configured to deliver a signal e.sub.2 indicative of the average value of e.sub.2; and a first proportional-integral filter configured to receive e.sub.2 and deliver the phase correction term, .delta.. 15. The apparatus of claim 14, wherein the quadrature corrector further comprises a gain error detector that generates a gain error signal based upon the magnitude of the double-frequency signal, wherein the gain error signal has a zero average value when said magnitude is substantially zero. 16. The apparatus of claim 15, wherein the gain error detector comprises: a second phase comparator that receives a signal indicative of the phase of the AC grid and delivers a signal: .times..times.<.function..theta..pi.<.pi. ##EQU00038## a second multiplier that delivers a gain error signal, e.sub.1=Q.sub.1 .sub.in; a third low pass filter configured to deliver a signal e.sub.1 indicative of the average value of e.sub.1; and a second proportional-integral filter configured to receive e.sub.1 and deliver the gain correction term, k. 17. The apparatus of claim 1, wherein the input converter is a current-controlled converter. 18. The apparatus of claim 1, wherein the input converter is a boost switching power converter. 19. The apparatus of claim 18, wherein the boost switching power converter comprises an isolation transformer for providing galvanic isolation between the input source and the unipolar bus. 20. The apparatus of claim 1, wherein the output converter controller is configured to control the output converter to deliver power to the AC grid in the form of a substantially sinusoidal current at the grid frequency. 21. The apparatus of claim 1, further comprising an output filter connected between the output converter and the AC grid. 22. The apparatus of claim 1, wherein the average power delivered to the AC grid by the output converter is controlled by the output converter controller to be substantially equal to the power delivered by the unipolar source less the substantial total of the power losses in the inverter. 23. The apparatus of claim 1, wherein the power delivered to the grid is controlled by the output controller to comprise an average power component and a time-varying power component. 24. The apparatus of claim 23, wherein the output converter controller is configured to comprise a feedforward controller configured to receive: a measurement of the power delivered to the input converter by the unipolar input source, P.sub.S, a measurement of the rms grid voltage, V.sub.rms, a measurement of the grid phase, .theta., a pre-determined setpoint value of a power factor angle, .phi., and wherein the feedforward controller controls the output converter to deliver to the AC grid a time-varying component of current essentially equal to: i.sub.LFF(t)=( {square root over (2)}Ps/V.sub.rms)(cos(.theta.+.phi.)/cos(.phi.)). 25. The apparatus of claim 24, wherein: the energy storage element is a capacitor, C.sub.bus, and the output converter controller comprises a feedback controller that receives (i) a measurement of the average voltage across the unipolar bus, V.sub.bus0, and (ii) a pre-determined setpoint value indicative of a desired average value of the unipolar bus voltage, V.sub.bus*, wherein the feedback controller controls the output converter to deliver to the AC grid an additional time-varying component of current, which, when combined with i.sub.LFF(t), causes V.sub.bus0 to be substantially equal to V.sub.bus*. 26. The apparatus of claim 25, wherein the output converter controller is configured to alter the magnitude of V.sub.bus* as a function of selected inverter operating conditions. 27. The apparatus of claim 26, wherein the selected inverter operating conditions comprise the operating power of the converter and the AC grid voltage. 28. The apparatus of claim 25, wherein the output converter controller comprises a filter that receives a measurement of the voltage across the unipolar bus, V.sub.bus, and delivers the measurement of the average voltage across the unipolar bus, V.sub.bus0. 29. The apparatus of claim 28, wherein the filter comprises a low-frequency rolloff filter having a pole at a frequency equal to one-tenth of the grid frequency. 30. The apparatus of claim 1, wherein the output converter comprises a full-bridge switching circuit comprising controllable switches configured to receive power from the unipolar bus and deliver power to the AC grid. 31. A method for controlling an inverter that is configured to deliver power from a unipolar input source to an alternating-current ("AC") grid at a grid voltage and grid phase, comprising: delivering a pre-determined amount of power from the unipolar input source to a unipolar bus using an input converter; supplying energy to and absorbing energy from the unipolar bus using an energy storage capacitor; delivering power from the unipolar bus to the AC grid using an output converter; and controlling the operation of the inverter using an inverter controller, wherein controlling the operation of the inverter comprises: (i) calculating a duty cycle for the input converter such that (a) the input converter delivers the pre-determined amount of power and (b) the magnitude of a ripple signal reflected into the input source may be attenuated toward zero, and (ii) determining the effectiveness of the calculation in attenuating the ripple and adaptively altering the calculation to improve the effectiveness of the calculation. 32. The method of claim 31, wherein: delivering the predetermined amount of power comprises delivering the predetermined amount of power from the unipolar input source to the unipolar bus using an input converter comprising a switching power converter, and controlling the operation of the input converter comprises controlling the input converter using an input converter controller of the inverter controller. 33. The method of claim 31, wherein: delivering power from the unipolar bus to the AC grid comprises delivering power from the unipolar bus to the AC grid using an output converter comprising a switching power converter, and controlling the operation of the output converter comprises controlling the output converter using an output converter controller of the inverter controller to deliver power to the AC grid. 34. The method of claim 31, wherein the energy storage element comprises a bus capacitor and the input converter comprises a switching power converter, and wherein controlling the input converter comprises: providing to the inverter controller: a value indicative of the size of the bus capacitor, C.sub.bus, a value indicative of the grid frequency, .omega., a measurement of the rms grid voltage, V.sub.rms, a measurement of the rms inverter output current, I.sub.rms, a measurement of the unipolar bus voltage, V.sub.bus0, a measurement of the grid phase, .theta.; calculating a duty cycle for the input converter by: adjusting a nominal duty cycle, d.sub.0, to a value that is consistent with delivering the pre-determined amount of power, calculating a correction term, {tilde over (d)}, for attenuating a reflected ripple signal, .sub.r, at a frequency 2.omega.: .function..times..times..times..omega..times..times..times..times..times.- .times..function..times..omega..times..times..delta. ##EQU00039## and setting the input converter duty cycle equal to: d={tilde over (d)}+d.sub.0; and assessing the effectiveness of the calculation of the correction term in attenuating the said reflected ripple signal and adaptively altering the values of k and .delta. to improve the effectiveness. 35. The method of claim 34, wherein assessing the effectiveness comprises: generating a signal, Q.sub.1: .times..times.<.function..theta..pi.<.pi. ##EQU00040## multiplying Q.sub.1 and the reflected ripple signal to generate an error signal, e.sub.1=Q.sub.1 .sub.in; and controlling the value of k to reduce the average value of e.sub.1 towards zero. 36. The method of claim 34, wherein assessing the effectiveness comprises: generating a signal, Q.sub.2: .times..times..pi.<.function..theta..pi.<.times..pi. ##EQU00041## multiplying Q.sub.2 and the reflected ripple signal to generate an error signal, e.sub.2=Q.sub.2 .sub.r; and controlling the value of .delta. to reduce the average value of e.sub.2 towards zero. 37. The method of claim 31, wherein the energy storage element comprises a bus capacitor, the input converter comprises a switching power converter and controlling the input converter comprises: providing to the inverter controller: a value indicative of the size of the bus capacitor, C.sub.bus, a value indicative of the grid frequency, .omega., a value, .phi., indicative of a phase difference between the phase of the current delivered to the AC grid and the phase of the AC grid voltage, a measurement of the inverter output power, P.sub.out, a measurement of the unipolar bus voltage, V.sub.bus0, a measurement of the grid phase, .theta.; calculating a duty cycle for the input converter by: adjusting a nominal duty cycle, d.sub.0, to a value that is consistent with delivering the pre-determined amount of power, calculating a correction term, {tilde over (d)}, for attenuating a reflected ripple signal, .sub.r, at a frequency 2.omega.: .function..times..times..omega..times..times..times..times..times..times.- .function..PHI..times..function..times..omega..times..times..delta. ##EQU00042## and setting the input converter duty cycle equal to: d={tilde over (d)}+d.sub.0; and assessing the effectiveness of the calculation of the correction term in attenuating the said reflected ripple signal and adaptively altering the values of k and .delta. to improve the effectiveness. 38. The method of claim 31, wherein the energy storage element comprises a bus capacitor, the input converter comprises a switching power converter and controlling the input converter comprises: providing to the inverter controller: a value indicative of the size of the bus capacitor, C.sub.bus, a value indicative of the grid frequency, .omega., a value indicative of the operating efficiency of the inverter, .eta., a value, .phi., indicative of a phase difference between the phase of the current delivered to the AC grid and the phase of the AC grid voltage, a measurement of the power delivered by the unipolar input source, P.sub.s, a measurement of the unipolar bus voltage, V.sub.bus0, a measurement of the grid phase, .theta.; and calculating a duty cycle for the input converter by: adjusting a nominal duty cycle, d.sub.0, to a value that is consistent with delivering the pre-determined amount of power, calculating a correction term, {tilde over (d)}, for attenuating a reflected ripple signal, .sub.r, at a frequency 2.omega.: .function..times..times..omega..times..times..times..times..times..times.- .function..PHI..times..function..times..omega..times..times..delta. ##EQU00043## and setting the input converter duty cycle equal to: d={tilde over (d)}+d.sub.0; and assessing the effectiveness of the calculation of the correction term in attenuating the said reflected ripple signal and adaptively altering the values of k and .delta. to improve the effectiveness. 39. The method of claim 31, wherein the energy storage element comprises a bus capacitor, the input converter comprises a switching power converter and controlling the input converter comprises: providing to the inverter controller: a value indicative of the size of the bus capacitor, C.sub.bus, a value indicative of the grid frequency, .omega., a value indicative of the operating efficiency of the inverter, .eta., a value, .phi., indicative of a phase difference between the phase of the current delivered to the AC grid and the phase of the AC grid voltage, a measurement of the voltage delivered by the unipolar input source, V.sub.s, a measurement of current delivered by the unipolar input source, I.sub.s, a measurement of the unipolar bus voltage, V.sub.bus0, a measurement of the grid phase, .theta.; and calculating a duty cycle for the input converter by: adjusting a nominal duty cycle, d.sub.0, to a value that is consistent with delivering the pre-determined amount of power; calculating a correction term, {tilde over (d)}, for attenuating a reflected ripple signal, .sub.r, at a frequency 2.omega.: .function..times..times..times..omega..times..times..times..times..times.- .times..function..PHI..times..function..times..omega..times..times..delta. ##EQU00044## and setting the input converter duty cycle equal to: d={tilde over (d)}+d.sub.0; and assessing the effectiveness of the calculation of the correction term in attenuating the said reflected ripple signal and adaptively altering the values of k and .delta. to improve the effectiveness. 