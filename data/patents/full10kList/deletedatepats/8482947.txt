An apparatus and method for controlling the delivery of power from a DC source to an AC grid includes an inverter configured to deliver power from the unipolar input source to the AC grid and an inverter controller. The inverter includes an input converter, an active filter, and an output converter. The inverter controller includes an input converter controller, an active filter controller and an output converter controller. The input converter controller is configured to control a current delivered by the input converter to a galvanically isolated unipolar bus of the inverter. The output converter is configured to control the output converter to deliver power to the AC grid. Additionally, the active filter controller is configured to control the active filter to supply substantially all the power that is deliver by the output controller to the AC grid at a grid frequency.
Claims The invention claimed is: 1. An apparatus for controlling the delivery of power from a photovoltaic ("PV") cell to an alternating-current (AC) grid at a grid voltage and grid frequency, the apparatus comprising: an inverter comprising: an input converter configured to deliver power from the PV cell to a galvanically isolated unipolar bus, the input converter comprising a maximum-power-point-tracking ("MPPT") device configured to determine the maximum amount of power that may be withdrawn from the photovoltaic cell and deliver a setpoint value, i.sub.SIC, for the current that is drawn by the input converter from the PV cell, wherein the input converter is further to receive a measurement of the voltage of the PV cell, V.sub.I, and to calculate and deliver a power delivery setpoint P.sub.s=V.sub.Ii.sub.SIC; an active filter configured to supply energy to and absorb energy from the unipolar bus; and an output converter configured to deliver power from the unipolar bus to the AC grid, and an inverter controller configured to maintain a voltage of the unipolar bus at a pre-determined value, the inverter controller comprising: an input converter controller to control a current delivered by the input converter to the unipolar bus; an output converter controller to control the output converter to deliver power to the AC grid; and an active filter controller to control the active filter to supply time-varying power to the output converter. 2. The apparatus of claim 1, wherein the active filter controller controls the active filter to supply substantially all of the time-varying power that is delivered to the output converter at the grid frequency and harmonics of the grid frequency. 3. The apparatus of claim 1, wherein the average power delivered to the grid by the output converter is controlled by the output converter controller to be substantially equal to the power delivered by the unipolar source less the substantial total of the power losses in the inverter. 4. The apparatus of claim 3, wherein the output converter controller is configured to comprise a feedforward controller configured to receive: a measurement of the power delivered to the input converter by the unipolar input source, P.sub.s, a measurement of the rms grid voltage, V.sub.L, a measurement of a time-varying phase of the AC grid, .theta., a pre-determined setpoint value of a power factor angle, .phi., and wherein the feedforward controller controls the output converter to deliver to the AC grid a time-varying component of current essentially equal to: i.sub.LFF(t)=(sqrt(2)Ps/V.sub.L)(cos(.theta.+.phi.)/cos(.phi.). 5. The apparatus of claim 4, wherein (i) the active filter is a switching power converter comprising an active filter capacitor and (ii) the active filter controller is configured to control the current in the active filter capacitor such that the active filter supplies substantially all of the time-varying delivered to the output converter at the grid frequency and harmonics of the grid frequency and in which the output converter controller comprises a feedback controller that receives: a measurement of the average voltage across the active filter capacitor, V.sub.CAFA, and a pre-determined setpoint value indicative of a desired average value of the voltage across the active filter capacitor, V.sub.CAFS, and wherein the feedback controller controls the output converter to deliver to the AC grid an additional time-varying component of current, which, when combined with i.sub.LFF(t), causes V.sub.CAFA to be essentially equal to V.sub.CAFS. 6. The apparatus of claim 5, wherein the output converter controller is configured to receive a measurement of the unipolar bus voltage V.sub.bus and to alter the magnitude of the current delivered to the AC grid based upon the value of V.sub.bus. 7. The apparatus of claim 6, wherein the output converter controller is configured to progressively reduce the magnitude of the current delivered to the AC grid as the value of V.sub.bus decreases below a pre-determined limit. 8. The apparatus of claim 5, wherein the output converter controller comprises a filter that receives a measurement of the voltage across the active filter capacitor and delivers the measurement of the average voltage across the active filter capacitor, v.sub.CAFA. 9. The apparatus of claim 8, wherein the filter comprises a notch filter configured to exhibit a sharp attenuation at a frequency equal to twice the grid frequency. 10. The apparatus of claim 9, wherein the filter further comprises a low-frequency rolloff filter having a pole at a frequency equal to one-tenth of the grid frequency. 11. The apparatus of claim 1, wherein the power delivered to the grid is controlled by the output controller to comprise an average power component and a time-varying component. 12. The apparatus of claim 11, wherein the active filter controller controls the active filter to deliver substantially all of the time-varying power. 13. The apparatus of claim 11, wherein the time-varying component comprises a component at twice the grid frequency. 14. The apparatus of claim 12, wherein the active filter is configured as a switching power converter comprising an active filter capacitor and the active filter controller controls the time-varying component by controlling all of the time-varying current that flows in the active filter capacitor. 15. The apparatus of claim 14, wherein the switching power converter comprises a half-bridge switching circuit comprising a pair of controllable switches connected to the active filter capacitor. 16. The apparatus of claim 14, wherein the switching power converter comprises a full-bridge switching circuit comprising two pairs of controllable switches connected to the active filter capacitor. 17. The apparatus of claim 14, wherein the active filter controller controls the switches so that the current in the active filter capacitor comprises a time-varying component comprising harmonics at multiples of the grid frequency. 18. The apparatus of claim 14, wherein the active filter controller controls the switches so that the voltage across the active filter capacitor is substantially unipolar. 19. The apparatus of claims 14, wherein the active filter controller is configured to receive a measurement of the unipolar bus voltage, V.sub.bus, and a setpoint value indicative of the said pre-determined value for the unipolar bus voltage, V.sub.Sbus, and to control the current flowing in the active filter capacitor, i.sub.CAF, so that the magnitude of a ripple voltage across the unipolar bus, at the grid frequency and harmonics of the grid frequency, is reduced towards zero. 20. The apparatus of claim 19, wherein the active filter controller comprises: a feedback controller that delivers a feedback control output, i.sub.FB, that is a function of the difference between V.sub.bus and V.sub.Sbus, and a scaling element that receives a measurement of the voltage across the active filter capacitor, v.sub.CAF, and delivers a scaled control output equal to i.sub.CAFI=i.sub.FB(V.sub.bus/ v.sub.CAF) wherein i.sub.CAFI is indicative of a time-varying magnitude of the current that is controlled to flow in the active filter capacitor. 21. The apparatus of claim 20, wherein the active filter controller comprises a voltage limiter configured to deliver to the active filter a setpoint, i.sub.SCAF, for the current that flows in the active filter capacitor, in accordance with the following logic: i.) if the voltage V.sub.CAF is less than a pre-determined upper voltage limit and greater than a pre-determined lower voltage limit, i.sub.SCAF is set equal to i.sub.CAFI; ii) if the voltage v.sub.CAF is less than the pre-determined lower voltage limit, i.sub.SCAF is forced to be of a polarity that causes v.sub.CAF to increase above the pre-determined lower voltage limit; and iii) if the voltage v.sub.CAF is greater than the pre-determined upper voltage limit, i.sub.SCAF is forced to be of a polarity that causes v.sub.CAF to decrease below the pre-determined upper voltage limit. 22. The apparatus of claim 1, wherein the output converter controller is configured control the output converter to deliver power to the AC grid in the form of a substantially sinusoidal current at the grid frequency. 23. The apparatus of claim 1, wherein the input converter controller is a current-mode controller. 24. The apparatus of claim 1, wherein the output converter controller is a current-mode controller. 25. The apparatus of claim 1, wherein the active filter controller is a current-mode controller. 26. The apparatus of claim 1, wherein the galvanic isolation is provided by a transformer. 27. The apparatus of claim 1, wherein the input converter is a current-fed converter. 28. The apparatus of claim 1, wherein the input converter is an isolated boost converter. 29. The apparatus of claim 1, wherein the unipolar input source is a photovoltaic cell. 30. The apparatus of claim 1, wherein the unipolar input source is a fuel cell. 31. The apparatus of claim 1, wherein the pre-determined value of the unipolar bus voltage is a constant value. 32. The apparatus of claim 1, wherein the pre-determined value of the unipolar bus voltage is a function of one or more variables. 33. The apparatus of claim 32, wherein the pre-determined value of the unipolar bus voltage is a function of the magnitude of the grid voltage. 34. The apparatus of claim 1, wherein the input converter controller is configured to control the current drawn by the input converter to be essentially equal to i.sub.SIC. 35. The apparatus of claim 1, wherein the input converter controller is configured to receive a measurement of the unipolar bus voltage V.sub.bus and to alter the value of i.sub.SIC based upon the value of V.sub.bus. 36. The apparatus of claim 35, wherein the input converter controller is configured to progressively reduce i.sub.SIC as the value of V.sub.bus increases above a pre-determined limit. 37. The apparatus of claim 1, wherein the output converter comprises a full-bridge switching circuit comprising two pairs of controllable switches configured to receive power from the unipolar bus and deliver power to the AC grid. 38. The apparatus of claim 1, further comprising an output filter connected between the output converter and the AC grid. 39. A method for controlling an inverter that is configured to deliver power from a unipolar input source to an alternating-current ("AC") grid at a grid voltage and grid phase, comprising: delivering a pre-determined amount of power from the unipolar input source to a unipolar bus that is galvanically isolated from the unipolar input source using an input converter; supplying energy to and absorbing energy from the unipolar bus using an active filter comprising an active filter capacitor; delivering power from the unipolar bus to the AC grid using an output converter; controlling the operation of the inverter using an inverter controller, wherein controlling the operation of the inverter comprises (i) controlling the operation of the input converter to deliver substantially all the average power delivered to the AC grid, (ii) controlling the active filter to deliver substantially all the time-varying power that is delivered to the AC grid, and (iii) regulating the unipolar bus voltage to a first pre-determined value; and providing to the output converter controller: a value indicative of the pre-determined amount of power, P.sub.s;. a measurement of the rms grid voltage, V.sub.L; a measurement of the grid phase, .theta., a pre-determined setpoint value of a power factor angle, .phi., and, wherein controlling the output converter comprises controlling the current delivered by the output converter to the AC grid to comprise a time-varying component essentially equal to: i.sub.LFF(t)=(sqrt(2)Ps/V.sub.L)(cos(.theta.+.phi.)/cos(.phi.). 40. The method of claim 39, wherein: delivering the predetermined amount of power comprises delivering the predetermined amount of power from the unipolar input source to the unipolar bus using an input converter comprising a switching power converter, and controlling the operation of the input converter comprises controlling the input converter using an input converter controller of the inverter controller to deliver the said substantially all the average power delivered to the AC grid. 41. The method of claim 39, wherein: supplying energy to and absorbing energy from the unipolar bus comprises supplying energy to and absorbing energy from the unipolar bus using an active filter comprising a switching power converter, and controlling the operation of the active filter comprises controlling the active filter using an active filter controller of the inverter controller to deliver the said substantially all of the time-varying power that is delivered to the AC grid. 42. The method of claim 39, wherein: delivering power from the unipolar bus to the AC grid comprises delivering power from the unipolar bus to the AC grid using an output converter comprising a switching power converter, and controlling the operation of the output converter comprises controlling the output converter using an output converter controller of the inverter controller to deliver power to the AC grid. 43. The method of claim 39, wherein controlling operation of the active filter comprises controlling a time-varying current that flows in the active filter capacitor. 44. The method of claim 39, wherein controlling operation of the active filter comprises: sensing the magnitude of the unipolar bus voltage, and controlling the current in the active filter to reduce the ripple across the unipolar bus towards zero. 45. The method of claim 39, wherein controlling the output converter comprises: controlling the magnitude of the current delivered by the output converter to the AC grid so that the average power delivered to the grid by the output converter is substantially equal to the power delivered by the unipolar source less the substantial total of the power losses in the inverter. 46. The method of claim 39, wherein regulating the unipolar bus voltage comprises: sensing the magnitude of the unipolar bus voltage, and controlling the magnitude of the current delivered by the output converter to the AC grid to maintain the average value of the unipolar bus voltage at the first pre-determined value. 47. The method of claim 46, further comprising; providing a second pre-determined value for an average value of the voltage across the active filter capacitor, comparing the average value of the unipolar bus voltage to the first pre-determined value, and, based upon the comparison, controlling the current in the active filter capacitor to alter the average value of the voltage across the active filter capacitor, and controlling the magnitude of the current delivered by the output converter to the AC grid to maintain the average value of the voltage across the active filter capacitor at the second pre-determined value. 48. The method of claim 39, wherein delivering a pre-determined amount of power from the unipolar input source comprises delivering a pre-determined amount of power from a photovoltaic cell, and further comprising: determining the pre-determined amount of power using a maximum-power-point-tracking ("MPPT") controller, and generating a power command indicative of the pre-determined amount of power and an input current command indicative of the current to be delivered by the photovoltaic cell current. 49. The method of claim 48 further comprising: controlling the current drawn from the photovoltaic cell by the input converter to be substantially equal to the input current command. 50. The method of claim 39 further comprising: providing to the output converter controller: a measurement of the average voltage across the active filter capacitor, V.sub.CAFA, a second pre-determined value indicative of a desired average value of the voltage across the active filter capacitor, V.sub.CAFS, and wherein controlling the output converter comprises controlling the current delivered by the output converter to the AC grid to comprise an additional time-varying component, which, when combined with i.sub.LFF(t), causes v.sub.CAFA to be essentially equal to V.sub.CAFS. 51. A method for improving efficiency in an inverter that is configured to deliver power from a unipolar input source to an alternating-current ("AC") grid at a grid voltage and grid phase and that operates in accordance with the method of claim 39, the method comprising: connecting the active filter directly to the unipolar bus. 